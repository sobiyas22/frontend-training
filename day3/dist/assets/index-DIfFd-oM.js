(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(e){if(e.ep)return;e.ep=!0;const c=n(e);fetch(e.href,c)}})();const N="day3_notes_spa_v1";function b(a){if(!a)return null;try{return JSON.parse(a)}catch{return null}}function C(){const a=b(localStorage.getItem(N));return a?a.filter(t=>typeof t?.id=="string"&&typeof t?.title=="string"&&typeof t?.content=="string"&&typeof t?.createdAt=="number").map(t=>({id:t.id,title:t.title,content:t.content,createdAt:t.createdAt})):[]}function E(a){localStorage.setItem(N,JSON.stringify(a))}function v(){return`n_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`}let l=[];function y(){if(l=C(),l.length===0){const a=Date.now();l=[{id:v(),title:"Welcome",content:`Create a note from the Create page.

This is a vanilla TypeScript SPA using components + client-side routing.`,createdAt:a}],E(l)}}function _(){return[...l].sort((a,t)=>t.createdAt-a.createdAt)}function x(a){return l.find(t=>t.id===a)}function w(a){const t={id:v(),title:a.title.trim(),content:a.content.trim(),createdAt:Date.now()};return l=[t,...l],E(l),t}function A(a){const t=l.length;return l=l.filter(n=>n.id!==a),l.length===t?!1:(E(l),!0)}function S(a){const t=[],n=a.split("/").map(o=>o.startsWith(":")?(t.push(o.slice(1)),"([^/]+)"):o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("/");return{pattern:new RegExp(`^${n}$`),keys:t}}class L{routes=[];onNotFound=()=>{};add(t,n){const{pattern:o,keys:e}=S(t);return this.routes.push({pattern:o,keys:e,handler:n}),this}setNotFound(t){return this.onNotFound=t,this}start(){window.addEventListener("popstate",()=>this.render(location.pathname)),this.render(location.pathname)}navigate(t){history.pushState({},"",t),this.render(t)}interceptLinks(){document.addEventListener("click",t=>{const o=t.target?.closest("a[data-link='true']");if(!o||o.target==="_blank"||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;const e=o.getAttribute("href");e&&e.startsWith("/")&&(t.preventDefault(),this.navigate(e))})}render(t){for(const n of this.routes){const o=t.match(n.pattern);if(!o)continue;const e={};n.keys.forEach((c,r)=>{e[c]=decodeURIComponent(o[r+1]??"")}),n.handler({path:t,params:e});return}this.onNotFound({path:t,params:{}})}}function g(a){return new Date(a).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}function k(a){const{note:t}=a,n=document.createElement("a");n.className="note",n.href=`/note/${encodeURIComponent(t.id)}`,n.setAttribute("data-link","true");const o=document.createElement("div");o.className="note__left";const e=document.createElement("h3");e.className="note__title",e.textContent=t.title||"(Untitled)";const c=document.createElement("div");return c.className="note__meta",c.textContent=g(t.createdAt),o.append(e,c),n.append(o),n}function D(a){const{notes:t}=a,n=document.createElement("div");if(n.className="list",t.length===0){const o=document.createElement("div");return o.className="empty",o.textContent="No notes yet. Create your first note.",n.append(o),n}for(const o of t)n.append(k({note:o}));return n}function I(){const a=document.createElement("div"),t=document.createElement("div");t.className="main__header";const n=document.createElement("div"),o=document.createElement("h1");o.textContent="All notes";const e=document.createElement("p");e.textContent="Click a note to view details.",n.append(o,e);const c=document.createElement("div"),r=document.createElement("a");r.className="btn btn--primary",r.href="/create",r.setAttribute("data-link","true"),r.textContent="Create note",c.append(r),t.append(n,c);const s=document.createElement("div");return s.className="main__content",s.append(D({notes:_()})),a.append(t,s),a}function T(a){const t={title:"",content:""},n=document.createElement("form"),o=document.createElement("label");o.textContent="Title";const e=document.createElement("input");e.type="text",e.placeholder="e.g. Shopping list",e.maxLength=80,e.addEventListener("input",()=>{t.title=e.value}),o.append(e);const c=document.createElement("label");c.textContent="Content";const r=document.createElement("textarea");r.placeholder="Write your note...",r.addEventListener("input",()=>{t.content=r.value}),c.append(r);const s=document.createElement("div");s.className="formActions";const i=document.createElement("button");i.type="submit",i.className="btn btn--primary",i.textContent="Create note";const d=document.createElement("button");d.type="button",d.className="btn",d.textContent="Cancel",d.addEventListener("click",()=>a.onCancel()),s.append(i,d);const m=document.createElement("div");return m.style.color="rgba(255,255,255,0.55)",m.style.fontSize="12px",m.textContent="Tip: Notes are saved in localStorage for this browser.",n.addEventListener("submit",h=>{h.preventDefault();const p=t.title.trim(),u=t.content.trim();!p&&!u||a.onSubmit({title:p||"(Untitled)",content:u})}),n.append(o,c,s,m),n}function O(a){const t=document.createElement("div"),n=document.createElement("div");n.className="main__header";const o=document.createElement("div"),e=document.createElement("h1");e.textContent="Create note";const c=document.createElement("p");c.textContent="Title + content, stored in localStorage.",o.append(e,c),n.append(o);const r=document.createElement("div");return r.className="main__content",r.append(T({onSubmit:({title:s,content:i})=>{w({title:s,content:i}),a.navigate("/")},onCancel:()=>a.navigate("/")})),t.append(n,r),t}function P(a){const{note:t}=a,n=document.createElement("div");n.className="detail";const o=document.createElement("h2");o.className="detail__title",o.textContent=t.title||"(Untitled)";const e=document.createElement("div");e.className="detail__meta",e.textContent=`Created ${g(t.createdAt)}`;const c=document.createElement("div");c.className="detail__content",c.textContent=t.content||"(No content)";const r=document.createElement("div");r.className="formActions";const s=document.createElement("a");s.className="btn",s.href="/",s.setAttribute("data-link","true"),s.textContent="Back";const i=document.createElement("button");return i.type="button",i.className="btn btn--danger",i.textContent="Delete",i.addEventListener("click",()=>a.onDelete(t.id)),r.append(s,i),n.append(o,e,r,c),n}function F(a,t){const n=document.createElement("div"),o=x(t);if(!o){const d=document.createElement("div");d.className="main__header";const m=document.createElement("div"),h=document.createElement("h1");h.textContent="Not found";const p=document.createElement("p");p.textContent="That note doesn't exist (maybe it was deleted).",m.append(h,p),d.append(m);const u=document.createElement("div");u.className="main__content";const f=document.createElement("a");return f.className="btn",f.href="/",f.setAttribute("data-link","true"),f.textContent="Back to notes",u.append(f),n.append(d,u),n}const e=document.createElement("div");e.className="main__header";const c=document.createElement("div"),r=document.createElement("h1");r.textContent="Note details";const s=document.createElement("p");s.textContent="View (and optionally delete) a note.",c.append(r,s),e.append(c);const i=document.createElement("div");return i.className="main__content",i.append(P({note:o,onDelete:d=>{A(d),a.navigate("/")}})),n.append(e,i),n}function $(a){const t=document.createElement("div"),n=document.createElement("div");n.className="main__header";const o=document.createElement("div"),e=document.createElement("h1");e.textContent="404";const c=document.createElement("p");c.textContent="Page not found.",o.append(e,c),n.append(o);const r=document.createElement("div");r.className="main__content";const s=document.createElement("button");return s.type="button",s.className="btn btn--primary",s.textContent="Go to Home",s.addEventListener("click",()=>a.navigate("/")),r.append(s),t.append(n,r),t}function V(){const a=document.createElement("div");a.className="container";const t=document.createElement("header");t.className="topbar";const n=document.createElement("a");n.className="brand",n.href="/",n.setAttribute("data-link","true");const o=document.createElement("div");o.className="brand__logo";const e=document.createElement("div");e.className="brand__title";const c=document.createElement("strong");c.textContent="Notes SPA";const r=document.createElement("span");r.textContent="Vanilla TS + Router + Vite",e.append(c,r),n.append(o,e);const s=document.createElement("nav");s.className="nav";const i=document.createElement("a");i.className="btn",i.href="/",i.setAttribute("data-link","true"),i.textContent="Home";const d=document.createElement("a");d.className="btn btn--primary",d.href="/create",d.setAttribute("data-link","true"),d.textContent="Create",s.append(i,d),t.append(n,s);const m=document.createElement("main");return m.className="main",a.append(t,m),{container:a,main:m}}function K(){y();const a=document.getElementById("app");if(!a)throw new Error("Missing #app");a.innerHTML="";const{container:t,main:n}=V();a.append(t);const o=new L,e=c=>{n.replaceChildren(c)};o.add("/",()=>e(I())).add("/create",()=>e(O(o))).add("/note/:id",({params:c})=>e(F(o,c.id))).setNotFound(()=>e($(o))),o.interceptLinks(),o.start()}K();
